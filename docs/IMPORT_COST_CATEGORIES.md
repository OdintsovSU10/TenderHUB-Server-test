# Инструкция по импорту затрат на строительство

## Формат Excel файла

Для импорта данных о затратах на строительство используйте Excel файл со следующей структурой:

### Структура колонок:
1. **Номер категории** (число) - порядковый номер для сортировки
2. **Категория затрат** (текст) - название основной категории
3. **Единица измерения категории** (текст) - единица измерения для категории
4. **Вид затраты** (текст) - детальное название работы/затраты
5. **Единица измерения детали** (текст) - единица измерения для конкретной работы
6. **Локация** (текст) - место проведения работ

### Поддерживаемые единицы измерения:
- шт (штуки)
- м (метры)
- м2 (квадратные метры)
- м3 (кубические метры)
- кг (килограммы)
- т (тонны)
- л (литры)
- компл (комплект)
- м.п. (метры погонные)

## Процесс импорта

1. Откройте страницу **"Затраты на строительство"** в административной панели
2. Нажмите кнопку **"Импорт из Excel"** в правом верхнем углу
3. Выберите подготовленный Excel файл
4. Дождитесь завершения импорта

## Как работает импорт

При импорте система автоматически:

1. **Создает категории затрат** (таблица `cost_categories`):
   - Проверяет существование категории по названию и единице измерения
   - Создает новые категории, если они отсутствуют
   - Избегает дублирования категорий

2. **Создает детальные записи** (таблица `detail_cost_categories`):
   - Привязывает каждую деталь к соответствующей категории
   - Сохраняет порядковый номер для правильной сортировки
   - Записывает локацию для каждой детали

## Важные моменты

- **Порядок сортировки**: Номер из первого столбца используется для упорядочивания записей внутри категории
- **Уникальность категорий**: Категории с одинаковым названием и единицей измерения считаются одной категорией
- **Обязательные поля**: Все 6 столбцов должны быть заполнены для корректного импорта

## Пример файла

Скачайте [шаблон файла](/template_cost_import.csv) для примера правильной структуры данных.

## Решение проблем

### Ошибка "Файл не может быть прочитан"
- Убедитесь, что файл имеет расширение .xlsx или .xls
- Проверьте, что файл не открыт в другой программе

### Данные не импортируются
- Проверьте соответствие структуры файла требуемому формату
- Убедитесь, что все обязательные поля заполнены
- Проверьте правильность единиц измерения

### Дублирование записей
- Система автоматически предотвращает дублирование категорий
- Детальные записи могут дублироваться при повторном импорте